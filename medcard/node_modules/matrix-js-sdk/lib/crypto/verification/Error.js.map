{"version":3,"file":"Error.js","names":["newVerificationError","code","reason","extraData","content","Object","assign","MatrixEvent","type","errorFactory","newUserCancelledError","newTimeoutError","newUnknownMethodError","newUnexpectedMessageError","newKeyMismatchError","newInvalidMessageError","errorFromEvent","event","getContent"],"sources":["../../../src/crypto/verification/Error.ts"],"sourcesContent":["/*\nCopyright 2018 - 2021 The Matrix.org Foundation C.I.C.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n\n/**\n * Error messages.\n *\n * @module crypto/verification/Error\n */\n\nimport { MatrixEvent } from \"../../models/event\";\n\nexport function newVerificationError(code: string, reason: string, extraData: Record<string, any>): MatrixEvent {\n    const content = Object.assign({}, { code, reason }, extraData);\n    return new MatrixEvent({\n        type: \"m.key.verification.cancel\",\n        content,\n    });\n}\n\nexport function errorFactory(code: string, reason: string): (extraData?: Record<string, any>) => MatrixEvent {\n    return function(extraData?: Record<string, any>) {\n        return newVerificationError(code, reason, extraData);\n    };\n}\n\n/**\n * The verification was cancelled by the user.\n */\nexport const newUserCancelledError = errorFactory(\"m.user\", \"Cancelled by user\");\n\n/**\n * The verification timed out.\n */\nexport const newTimeoutError = errorFactory(\"m.timeout\", \"Timed out\");\n\n/**\n * An unknown method was selected.\n */\nexport const newUnknownMethodError = errorFactory(\"m.unknown_method\", \"Unknown method\");\n\n/**\n * An unexpected message was sent.\n */\nexport const newUnexpectedMessageError = errorFactory(\n    \"m.unexpected_message\", \"Unexpected message\",\n);\n\n/**\n * The key does not match.\n */\nexport const newKeyMismatchError = errorFactory(\n    \"m.key_mismatch\", \"Key mismatch\",\n);\n\n/**\n * An invalid message was sent.\n */\nexport const newInvalidMessageError = errorFactory(\n    \"m.invalid_message\", \"Invalid message\",\n);\n\nexport function errorFromEvent(event: MatrixEvent): { code: string, reason: string } {\n    const content = event.getContent();\n    if (content) {\n        const { code, reason } = content;\n        return { code, reason };\n    } else {\n        return { code: \"Unknown error\", reason: \"m.unknown\" };\n    }\n}\n"],"mappings":";;;;;;;;;;AAsBA;;AAtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AAIO,SAASA,oBAAT,CAA8BC,IAA9B,EAA4CC,MAA5C,EAA4DC,SAA5D,EAAyG;EAC5G,MAAMC,OAAO,GAAGC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkB;IAAEL,IAAF;IAAQC;EAAR,CAAlB,EAAoCC,SAApC,CAAhB;EACA,OAAO,IAAII,kBAAJ,CAAgB;IACnBC,IAAI,EAAE,2BADa;IAEnBJ;EAFmB,CAAhB,CAAP;AAIH;;AAEM,SAASK,YAAT,CAAsBR,IAAtB,EAAoCC,MAApC,EAAsG;EACzG,OAAO,UAASC,SAAT,EAA0C;IAC7C,OAAOH,oBAAoB,CAACC,IAAD,EAAOC,MAAP,EAAeC,SAAf,CAA3B;EACH,CAFD;AAGH;AAED;AACA;AACA;;;AACO,MAAMO,qBAAqB,GAAGD,YAAY,CAAC,QAAD,EAAW,mBAAX,CAA1C;AAEP;AACA;AACA;;;AACO,MAAME,eAAe,GAAGF,YAAY,CAAC,WAAD,EAAc,WAAd,CAApC;AAEP;AACA;AACA;;;AACO,MAAMG,qBAAqB,GAAGH,YAAY,CAAC,kBAAD,EAAqB,gBAArB,CAA1C;AAEP;AACA;AACA;;;AACO,MAAMI,yBAAyB,GAAGJ,YAAY,CACjD,sBADiD,EACzB,oBADyB,CAA9C;AAIP;AACA;AACA;;;AACO,MAAMK,mBAAmB,GAAGL,YAAY,CAC3C,gBAD2C,EACzB,cADyB,CAAxC;AAIP;AACA;AACA;;;AACO,MAAMM,sBAAsB,GAAGN,YAAY,CAC9C,mBAD8C,EACzB,iBADyB,CAA3C;;;AAIA,SAASO,cAAT,CAAwBC,KAAxB,EAA8E;EACjF,MAAMb,OAAO,GAAGa,KAAK,CAACC,UAAN,EAAhB;;EACA,IAAId,OAAJ,EAAa;IACT,MAAM;MAAEH,IAAF;MAAQC;IAAR,IAAmBE,OAAzB;IACA,OAAO;MAAEH,IAAF;MAAQC;IAAR,CAAP;EACH,CAHD,MAGO;IACH,OAAO;MAAED,IAAI,EAAE,eAAR;MAAyBC,MAAM,EAAE;IAAjC,CAAP;EACH;AACJ"}